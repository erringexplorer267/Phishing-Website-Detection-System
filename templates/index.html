<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phishing Website Detection System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Import Poppins (Titles/Headings) and Montserrat (Body/Data) */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&family=Montserrat:wght@400;600;700&display=swap');
        
        /* Define a Light Mode Color Palette */
        :root {
            --primary-color: #3f51b5; /* A deep, professional blue */
            --secondary-color: #00bcd4; /* A supporting cyan for accents */
            --background-light: #f0f2f5; /* Very light grey background */
            --card-background: #ffffff; /* White cards */
            --text-dark: #212529; /* Dark text for readability */
            --text-medium: #6c757d; /* Medium grey text */
            --border-subtle: #e0e0e0; /* Light grey border */
            
            /* Status colors (Light mode friendly) */
            --status-good: #28a745; /* Green */
            --status-bad: #dc3545; /* Red */
            --status-error: #ffc107; /* Yellow */
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--background-light);
            color: var(--text-dark);
            background-image: radial-gradient(circle at 50% 10%, rgba(63, 81, 181, 0.05) 0%, transparent 50%), 
                              linear-gradient(to bottom right, #f8f9fa, #e9ecef); /* Subtle background pattern */
            background-attachment: fixed;
            transition: background-color 0.3s;
        }
        
        /* Card Style for Light Mode */
        .cyber-card {
            background-color: var(--card-background);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); /* Soft, subtle shadow */
            border: 1px solid var(--border-subtle);
            transition: all 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .cyber-card:hover {
            box-shadow: 0 15px 45px rgba(0, 0, 0, 0.15);
        }

        /* Header styling */
        .main-header {
            font-family: 'Poppins', sans-serif;
            color: var(--primary-color);
            letter-spacing: 1px;
        }

        /* Sub-Header/Report Header */
        h3, h2 {
            font-family: 'Poppins', sans-serif;
            color: var(--text-dark);
        }
        
        /* Input field enhancements */
        .cyber-input {
            background-color: #ffffff; 
            border: 1px solid var(--border-subtle);
            color: var(--text-dark);
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.05); /* Subtle inner shadow */
            font-family: 'Montserrat', sans-serif; 
        }

        .cyber-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(63, 81, 181, 0.2), inset 0 2px 5px rgba(0, 0, 0, 0.08); /* Soft focus ring */
            background-color: #ffffff;
        }

        /* Button styling: Primary button */
        .btn-scan {
            background: var(--primary-color);
            color: white;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(63, 81, 181, 0.4);
            border: none;
        }

        .btn-scan:hover {
            background: #5c6bc0; /* Slightly lighter shade on hover */
            box-shadow: 0 8px 20px rgba(63, 81, 181, 0.5);
            transform: translateY(-2px);
        }

        /* Reset button style update */
        .reset-btn {
            background-color: #e9ecef;
            border: 1px solid var(--border-subtle);
            color: var(--text-dark);
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            font-family: 'Montserrat', sans-serif;
        }
        
        .reset-btn:hover {
            background-color: #dee2e6;
            color: var(--primary-color);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }

        /* Result boxes */
        .result-good {
            border-color: var(--status-good);
            background: #e6ffed; 
            color: var(--status-good);
            box-shadow: 0 0 10px rgba(40, 167, 69, 0.2);
            font-family: 'Poppins', sans-serif;
        }

        .result-bad {
            border-color: var(--status-bad);
            background: #ffe6e6; 
            color: var(--status-bad);
            box-shadow: 0 0 10px rgba(220, 53, 69, 0.2);
            font-family: 'Poppins', sans-serif;
        }

        .result-error {
            border-color: var(--status-error);
            background: #fff8e1; 
            color: var(--status-error);
            box-shadow: 0 0 10px rgba(255, 193, 7, 0.2);
            font-family: 'Poppins', sans-serif;
        }
        
        /* Analysis and History Containers */
        .analysis-container, .history-log {
             background-color: var(--card-background);
             border: 1px solid var(--border-subtle);
             box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        /* Analysis items */
        .analysis-item {
            background: #f8f9fa;
            border-left: 3px solid var(--secondary-color);
            color: var(--text-dark);
            font-family: 'Montserrat', sans-serif;
        }

        .analysis-item:hover {
            background: #e9ecef;
        }

        /* History log styling */
        .history-item {
            transition: background-color 0.2s;
            border-left-width: 4px;
        }

        .history-item span {
            color: var(--text-dark); 
        }
        
        /* Custom history item colors for light mode */
        .history-item.border-green-500 { border-left-color: var(--status-good); background: #f1fff1; }
        .history-item.border-green-500:hover { background: #e0f6e0; }
        
        .history-item.border-red-500 { border-left-color: var(--status-bad); background: #fff1f1; }
        .history-item.border-red-500:hover { background: #fbe0e0; }

        .history-item.border-yellow-500 { border-left-color: var(--status-error); background: #fffae6; }
        .history-item.border-yellow-500:hover { background: #f5eacf; }
        
        /* Overrides for text color in specific items */
        .history-item .text-green-700 { color: var(--status-good); }
        .history-item .text-red-700 { color: var(--status-bad); }
        .history-item .text-yellow-700 { color: var(--status-error); }
        
        .history-item .bg-green-500 { background-color: var(--status-good); color: white; }
        .history-item .bg-red-500 { background-color: var(--status-bad); color: white; }
        .history-item .bg-yellow-500 { background-color: var(--status-error); color: var(--text-dark); } /* Dark text on yellow for contrast */

    </style>
</head>
<body class="relative">
    <div class="min-h-screen flex flex-col items-center justify-center p-4 relative z-10">
        
        <div class="w-full max-w-2xl cyber-card p-10 rounded-3xl shadow-lg transition duration-300">
            <div class="text-center mb-8">
                <div class="inline-block p-4 rounded-full mb-4 bg-gray-100 border-2 border-primary-color" style="color: var(--primary-color);">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                    </svg>
                </div>
                <h1 class="text-5xl font-bold mb-3 main-header tracking-tight">
                    CYBER-SHIELD | URL SCAN
                </h1>
                <p class="text-gray-600 text-lg font-normal">
                    Advanced Phishing & Threat Detection System
                </p>
            </div>

            <form method="POST" action="/" class="flex flex-col gap-6" onsubmit="return validateInput(event)">
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary-color" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" />
                        </svg>
                    </div>
                    <input 
                        type="text" 
                        name="url" 
                        id="url_input"
                        placeholder="Enter URL (e.g., https://example.com)"
                        class="cyber-input w-full pl-14 pr-5 py-5 rounded-xl text-lg focus:outline-none placeholder-gray-500"
                        required
                    >
                </div>
                
                <div id="validation-message" class="text-sm text-red-600 hidden px-2 font-normal">
                    âš  Input does not look like a domain or URL. Please enter a proper address.
                </div>
                
                <div class="flex gap-4">
                    <button 
                        type="button" 
                        onclick="clearInputAndResult()"
                        class="reset-btn w-1/3 font-semibold py-4 rounded-xl transition duration-300 shadow-sm uppercase text-xs tracking-widest"
                    >
                        [ CLEAR ]
                    </button>
                    <button 
                        type="submit" 
                        class="btn-scan w-2/3 font-bold py-4 rounded-xl transition duration-300 uppercase tracking-wider shadow-lg relative z-10 text-base"
                    >
                        âš¡ INITIATE SCAN
                    </button>
                </div>
            </form>

            {% if predict_message %}
            <div id="result-box" 
                 class="mt-8 p-6 border-2 rounded-2xl font-bold text-xl text-center transition duration-300 relative overflow-hidden {{ 'result-' + predict_class if predict_class else 'result-error' }}"
            >
                {{ predict_message | safe }}
                {% if url_checked %}
                <p class="text-xs mt-4 opacity-70 font-normal">Scanned URL: <span class="truncate block font-normal text-sm mt-1 text-gray-700">{{ url_checked }}</span></p>
                {% endif %}
            </div>
            {% endif %}

            {% if analysis_results %}
            <div class="mt-8 analysis-container p-6 rounded-2xl border border-primary-color/30">
                <h3 class="text-2xl font-bold text-gray-800 mb-6 flex items-center border-b border-primary-color/50 pb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 mr-3" style="color: var(--secondary-color);" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    <span style="color: var(--secondary-color);">SYSTEM ANALYSIS REPORT</span>
                </h3>
                <ul class="space-y-4">
                    {% for item in analysis_results %}
                    <li class="analysis-item p-4 rounded-lg text-sm text-gray-700 font-normal border-l-4">
                        {{ item | safe }}
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}

        </div> 
        
        {% if session.history %}
        <div class="w-full max-w-2xl mt-8 cyber-card p-8 rounded-3xl shadow-lg history-log">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b border-primary-color/50 pb-4 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 mr-3" style="color: var(--primary-color);" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                SCAN HISTORY | LOGS
            </h2>
            <ul class="space-y-3">
                {% for item in session.history %}
                <li class="history-item p-4 rounded-xl flex items-center justify-between transition duration-300 border-l-4
                            {% if item.result == 'good' %} border-green-500
                            {% elif item.result == 'bad' %} border-red-500
                            {% else %} border-yellow-500 {% endif %}">
                    <span class="truncate font-medium text-sm w-3/4
                                    {% if item.result == 'good' %} text-green-700
                                    {% elif item.result == 'bad' %} text-red-700
                                    {% else %} text-yellow-700 {% endif %}">
                        {{ item.url }}
                    </span>
                    <span class="font-bold text-right text-xs uppercase px-3 py-2 rounded-full
                                    {% if item.result == 'good' %} bg-green-500 text-white 
                                    {% elif item.result == 'bad' %} bg-red-500 text-white 
                                    {% else %} bg-yellow-500 text-gray-900 {% endif %}">
                        {{ item.result }}
                    </span>
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    </div>

    <script>
        // *** JAVASCRIPT LOGIC REMAINS COMPLETELY UNCHANGED ***
        function validateInput(event) {
            const inputField = document.getElementById('url_input');
            const messageBox = document.getElementById('validation-message');
            let url = inputField.value.trim();

            if (!url) { 
                messageBox.textContent = "âš  Please enter a URL.";
                messageBox.classList.remove('hidden');
                event.preventDefault(); 
                return false;
            }

            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                if (url.includes('.')) {
                    url = 'https://' + url;
                    inputField.value = url;
                } else {
                    messageBox.textContent = "âš  Input does not look like a domain or URL. Please enter a proper address.";
                    messageBox.classList.remove('hidden');
                    event.preventDefault(); 
                    return false;
                }
            }
            
            messageBox.classList.add('hidden');
            return true; 
        }

        function clearInputAndResult() {
            document.getElementById('url_input').value = '';
            
            const resultBox = document.getElementById('result-box');
            if (resultBox) {
                resultBox.remove(); 
            }
            
            const analysisBox = document.querySelector('.mt-8.analysis-container');
            if (analysisBox) {
                analysisBox.remove();
            }

            document.getElementById('validation-message').classList.add('hidden');
        }
    </script>
</body>
</html>